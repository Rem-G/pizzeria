{"ast":null,"code":"var _jsxFileName = \"/Users/remi/Desktop/Polytech/4A/INFO734/TP/Pizzeria/React/src/pages/Order.js\";\nimport React, { useEffect, useState } from 'react';\nimport Modal from 'react-bootstrap/Modal';\nimport Button from 'react-bootstrap/Button';\nimport Form from 'react-bootstrap/Form';\nimport Card from '@material-ui/core/Card';\nimport CardActions from '@material-ui/core/CardActions';\nimport CardContent from '@material-ui/core/CardContent';\nimport Typography from '@material-ui/core/Typography';\nimport { useLocation, Redirect } from 'react-router-dom';\nimport axios from \"axios\";\nimport jwt_decode from \"jwt-decode\";\n\nfunction Order({\n  user_token\n}) {\n  const styles = {\n    root: {\n      width: \"30%\",\n      marginLeft: \"35%\"\n    },\n    bullet: {\n      display: 'inline-block',\n      margin: '0 2px',\n      transform: 'scale(0.8)'\n    },\n    title: {\n      alignItems: \"center\"\n    },\n    card_content: {\n      display: \"block\",\n      textAlign: \"center\"\n    },\n    order: {\n      display: \"block\",\n      textAlign: \"center\"\n    }\n  };\n  const [pizzas_order, setPizzasOrder] = useState([]);\n  const [name, setName] = useState(\"\");\n  const [surname, setSurname] = useState(\"\");\n  const [email, setEmail] = useState(\"\");\n  const [modal, setShowModal] = useState(false);\n  const [orderCheck, setShowModalCheck] = useState(false);\n  const [orderFail, setShowModalFail] = useState(false);\n  const [redirect, setRedirect] = useState(false);\n  const [username, setUsername] = useState(\"tempUser\");\n  const get_cart = useLocation().state;\n  useEffect(() => {\n    if (get_cart) {\n      setPizzasOrder(get_cart.cart.cart);\n    }\n\n    if (user_token.user_token !== \"\") {\n      setUsername(jwt_decode(user_token.user_token.username));\n    } // eslint-disable-next-line react-hooks/exhaustive-deps\n\n  }, []);\n\n  const prixPizzas = () => {\n    let prix = 0;\n    pizzas_order.forEach(pizza => {\n      prix += pizza.prix;\n    });\n    return prix;\n  };\n\n  const handleCloseModal = () => setShowModal(false);\n\n  const handleShowModal = () => setShowModal(true);\n\n  const handleCloseModalCheck = () => {\n    setShowModalCheck(false);\n    setRedirect(true);\n  };\n\n  const handleShowModalCheck = () => setShowModalCheck(true);\n\n  const handleCloseModalFail = () => {\n    setShowModalFail(false);\n    setRedirect(true);\n  };\n\n  const handleShowModalFail = () => setShowModalFail(true);\n\n  const handleSubmitCart = () => {\n    axios({\n      method: 'post',\n      url: 'http://localhost:3000/api/v1/createClient',\n      data: {\n        nom: name + \" \" + surname,\n        email: email,\n        username: username\n      }\n    }).then(response => {\n      axios({\n        method: 'post',\n        url: 'http://localhost:3000/api/v1/createCommande',\n        data: {\n          pizzas: pizzas_order,\n          client: response.data._id\n        }\n      }).then(res_order => {\n        setShowModal(false);\n\n        if (res_order.status === 200) {\n          setShowModalCheck(true);\n        } else {\n          setShowModalFail(true);\n        }\n      });\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    style: {\n      background: \"transparent\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 13\n    }\n  }, \"Finalisation de votre commande\"), /*#__PURE__*/React.createElement(Card, {\n    style: styles.root,\n    variant: \"outlined\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(CardContent, {\n    style: styles.card_content,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 21\n    }\n  }, \"Votre commande :\"), /*#__PURE__*/React.createElement(\"h4\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 21\n    }\n  }, pizzas_order.length, \" pizza(s)\"), /*#__PURE__*/React.createElement(\"ul\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 21\n    }\n  }, pizzas_order.map(pizza => /*#__PURE__*/React.createElement(\"li\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 29\n    }\n  }, pizza.nom))), /*#__PURE__*/React.createElement(Typography, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 21\n    }\n  }, \"Prix : \", prixPizzas(), \" \\u20AC\")), /*#__PURE__*/React.createElement(CardActions, {\n    style: styles.order,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    size: \"small\",\n    variant: \"success\",\n    onClick: handleShowModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 17\n    }\n  }, \"Valider\"))), modal && pizzas_order.length > 0 && /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Modal, {\n    show: handleShowModal,\n    onHide: handleCloseModal,\n    backdrop: \"static\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(Modal.Header, {\n    closeButton: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Modal.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 25\n    }\n  }, \"Validation de votre commande\")), /*#__PURE__*/React.createElement(Modal.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Form, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(Form.Group, {\n    controlId: \"formBasiName\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 37\n    }\n  }, \"Pr\\xE9nom\"), /*#__PURE__*/React.createElement(Form.Control, {\n    type: \"text\",\n    placeholder: \"Pr\\xE9nom\",\n    onChange: e => setName(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 37\n    }\n  })), /*#__PURE__*/React.createElement(Form.Group, {\n    controlId: \"formBasicSurname\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 37\n    }\n  }, \"Nom\"), /*#__PURE__*/React.createElement(Form.Control, {\n    type: \"text\",\n    placeholder: \"Nom\",\n    onChange: e => setSurname(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 37\n    }\n  })), /*#__PURE__*/React.createElement(Form.Group, {\n    controlId: \"formBasicSurname\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 37\n    }\n  }, \"Email\"), /*#__PURE__*/React.createElement(Form.Control, {\n    type: \"text\",\n    placeholder: \"Email\",\n    onChange: e => setEmail(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 37\n    }\n  })))), /*#__PURE__*/React.createElement(Modal.Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    size: \"small\",\n    variant: \"success\",\n    onClick: handleSubmitCart,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 25\n    }\n  }, \"Valider\"), /*#__PURE__*/React.createElement(Button, {\n    variant: \"secondary\",\n    onClick: handleCloseModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 25\n    }\n  }, \"Fermer\")))), orderCheck && /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Modal, {\n    show: handleShowModalCheck,\n    onHide: handleCloseModalCheck,\n    backdrop: \"static\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(Modal.Header, {\n    closeButton: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 25\n    }\n  }), /*#__PURE__*/React.createElement(Modal.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 25\n    }\n  }, \"Votre commande a \\xE9t\\xE9 valid\\xE9e !\"), /*#__PURE__*/React.createElement(Modal.Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    variant: \"secondary\",\n    onClick: handleCloseModalCheck,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 25\n    }\n  }, \"Fermer\")))), orderFail && /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Modal, {\n    show: handleShowModalFail,\n    onHide: handleCloseModalFail,\n    backdrop: \"static\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(Modal.Header, {\n    closeButton: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 25\n    }\n  }), /*#__PURE__*/React.createElement(Modal.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 25\n    }\n  }, \"Votre commande a \\xE9chou\\xE9, veuillez r\\xE9essayer\"), /*#__PURE__*/React.createElement(Modal.Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    variant: \"secondary\",\n    onClick: handleCloseModalFail,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 25\n    }\n  }, \"Fermer\")))), redirect && /*#__PURE__*/React.createElement(Redirect, {\n    to: \"/\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 17\n    }\n  }));\n}\n\nexport default Order;","map":{"version":3,"sources":["/Users/remi/Desktop/Polytech/4A/INFO734/TP/Pizzeria/React/src/pages/Order.js"],"names":["React","useEffect","useState","Modal","Button","Form","Card","CardActions","CardContent","Typography","useLocation","Redirect","axios","jwt_decode","Order","user_token","styles","root","width","marginLeft","bullet","display","margin","transform","title","alignItems","card_content","textAlign","order","pizzas_order","setPizzasOrder","name","setName","surname","setSurname","email","setEmail","modal","setShowModal","orderCheck","setShowModalCheck","orderFail","setShowModalFail","redirect","setRedirect","username","setUsername","get_cart","state","cart","prixPizzas","prix","forEach","pizza","handleCloseModal","handleShowModal","handleCloseModalCheck","handleShowModalCheck","handleCloseModalFail","handleShowModalFail","handleSubmitCart","method","url","data","nom","then","response","pizzas","client","_id","res_order","status","background","length","map","e","target","value"],"mappings":"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","sourcesContent":["import React, { useEffect , useState} from 'react';\nimport Modal from 'react-bootstrap/Modal';\nimport Button from 'react-bootstrap/Button';\nimport Form from 'react-bootstrap/Form';\n\nimport Card from '@material-ui/core/Card';\nimport CardActions from '@material-ui/core/CardActions';\nimport CardContent from '@material-ui/core/CardContent';\nimport Typography from '@material-ui/core/Typography';\nimport {useLocation, Redirect} from 'react-router-dom';\nimport axios from \"axios\";\nimport jwt_decode from \"jwt-decode\";\n\n\nfunction Order({user_token}){\n    const styles = {\n        root: {\n            width: \"30%\",\n            marginLeft: \"35%\"\n        },\n        bullet: {\n          display: 'inline-block',\n          margin: '0 2px',\n          transform: 'scale(0.8)',\n        },\n        title: {\n          alignItems: \"center\",\n        },\n        card_content: {\n          display: \"block\",\n          textAlign: \"center\"\n        },\n    \n        order: {\n          display: \"block\",\n          textAlign: \"center\",\n        }\n      };\n\n    const [pizzas_order, setPizzasOrder] = useState([]);\n    const [name, setName] = useState(\"\");\n    const [surname, setSurname] = useState(\"\");\n    const [email, setEmail] = useState(\"\");\n    const [modal, setShowModal] = useState(false);\n    const [orderCheck, setShowModalCheck] = useState(false);\n    const [orderFail, setShowModalFail] = useState(false);\n    const [redirect, setRedirect] = useState(false);\n    const [username, setUsername] = useState(\"tempUser\")\n\n    const get_cart = useLocation().state;\n\n    useEffect(() => {\n        if (get_cart){setPizzasOrder(get_cart.cart.cart);}\n        if (user_token.user_token !== \"\") {setUsername(jwt_decode(user_token.user_token.username));} \n        // eslint-disable-next-line react-hooks/exhaustive-deps\n      }, []);\n\n    const prixPizzas = () => {let prix=0; pizzas_order.forEach(pizza => {prix += pizza.prix;}); return prix;}\n\n    const handleCloseModal = () => setShowModal(false);\n    const handleShowModal = () => setShowModal(true);\n\n    const handleCloseModalCheck = () => {setShowModalCheck(false); setRedirect(true);};\n    const handleShowModalCheck = () => setShowModalCheck(true);\n\n    const handleCloseModalFail = () => {setShowModalFail(false); setRedirect(true);};\n    const handleShowModalFail = () => setShowModalFail(true);\n\n    const handleSubmitCart = () => {\n        axios({\n            method: 'post',\n            url: 'http://localhost:3000/api/v1/createClient',\n            data : {\n                nom: name + \" \" + surname,\n                email: email,\n                username: username,\n            }\n        }).then(response => {\n            axios({\n                method: 'post',\n                url: 'http://localhost:3000/api/v1/createCommande',\n                data : {\n                    pizzas: pizzas_order,\n                    client: response.data._id\n                }\n            }).then(res_order => {\n                setShowModal(false);\n                if (res_order.status === 200){\n                    setShowModalCheck(true);\n                }\n                else{\n                    setShowModalFail(true);\n                }\n            });\n        });\n    }\n\n    return (\n        <div>\n            <h1 style={{background: \"transparent\"}}>Finalisation de votre commande</h1>\n            <Card style={styles.root} variant=\"outlined\">\n                <CardContent style={styles.card_content}>\n                    <h3>Votre commande :</h3>\n                    <h4>{pizzas_order.length} pizza(s)</h4>\n                    <ul>\n                        {pizzas_order.map((pizza) => \n                            <li>{pizza.nom}</li>\n                        )}\n                    </ul>\n                    <Typography>\n                        Prix : {prixPizzas()} €\n                    </Typography>\n                </CardContent>\n            <CardActions style={styles.order}>\n                <Button size=\"small\" variant=\"success\" onClick={handleShowModal} >Valider</Button>\n            </CardActions>\n            </Card>\n\n            {modal && pizzas_order.length > 0 &&\n                <div>\n                    <Modal\n                    show={handleShowModal}\n                    onHide={handleCloseModal}\n                    backdrop=\"static\"\n                    >\n                        <Modal.Header closeButton>\n                        <Modal.Title>Validation de votre commande</Modal.Title>\n                        </Modal.Header>\n                        <Modal.Body>\n                            <Form>\n                                <Form.Group controlId=\"formBasiName\">\n                                    <Form.Label>Prénom</Form.Label>\n                                    <Form.Control type=\"text\" placeholder=\"Prénom\" onChange={e => setName(e.target.value)}/>\n                                </Form.Group>\n\n                                <Form.Group controlId=\"formBasicSurname\">\n                                    <Form.Label>Nom</Form.Label>\n                                    <Form.Control type=\"text\" placeholder=\"Nom\" onChange={e => setSurname(e.target.value)}/>\n                                </Form.Group>\n\n                                <Form.Group controlId=\"formBasicSurname\">\n                                    <Form.Label>Email</Form.Label>\n                                    <Form.Control type=\"text\" placeholder=\"Email\" onChange={e => setEmail(e.target.value)}/>\n                                </Form.Group>\n\n                            </Form>\n                        </Modal.Body>\n                        <Modal.Footer>\n                        <Button size=\"small\" variant=\"success\" onClick={handleSubmitCart}>Valider</Button>\n                        <Button variant=\"secondary\" onClick={handleCloseModal}>Fermer</Button>\n                        </Modal.Footer>\n                    </Modal>\n                </div>\n            }\n\n            {orderCheck && \n                <div>\n                    <Modal\n                    show={handleShowModalCheck}\n                    onHide={handleCloseModalCheck}\n                    backdrop=\"static\"\n                    >\n                        <Modal.Header closeButton>\n                        </Modal.Header>\n                        <Modal.Body>\n                            Votre commande a été validée !\n                        </Modal.Body>\n                        <Modal.Footer>\n                        <Button variant=\"secondary\" onClick={handleCloseModalCheck}>Fermer</Button>\n                        </Modal.Footer>\n                    </Modal>\n                </div>\n            }\n\n            {orderFail && \n                <div>\n                    <Modal\n                    show={handleShowModalFail}\n                    onHide={handleCloseModalFail}\n                    backdrop=\"static\"\n                    >\n                        <Modal.Header closeButton>\n                        </Modal.Header>\n                        <Modal.Body>\n                            Votre commande a échoué, veuillez réessayer\n                        </Modal.Body>\n                        <Modal.Footer>\n                        <Button variant=\"secondary\" onClick={handleCloseModalFail}>Fermer</Button>\n                        </Modal.Footer>\n                    </Modal>\n                </div>\n            }\n\n            {redirect &&\n                <Redirect to=\"/\" />\n            }\n        </div>\n    )\n}\n\nexport default Order;"]},"metadata":{},"sourceType":"module"}